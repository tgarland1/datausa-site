<!doctype html>
<html>

  <head>
    <title>D3plus</title>
    <!-- loading D3plus JS file -->
    <script src="./jquery-2.2.2.min.js"></script>
    <script src="./data/mortality.js"></script>
    <script src="js/d3plus.full.min.js"></script>
    
    <!-- Optional theme -->
    <link rel="stylesheet" href="css/bootstrap-them.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="js/bootstrap_3_3_6.js"></script>
	<!-- css style -->
	<link type="text/css" rel="stylesheet" media="all" href="../css/site.css?v=28" />
    <link type="text/css" rel="stylesheet" media="all" href="../css/font-awesome-4.3.0/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="../css/main.css">
    
    
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
	<style>
		html {
			font-size: 10px;
			-webkit-tap-highlight-color: rgba(0,0,0,0);
		}
		body.profile {
			position: relative;
			left: 0;
			right: 0;
			overflow-x: hidden;
			overflow-y: hidden;
		}
		body {
			font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
			font-size: 14px;
			line-height: 1.42857143;
			color: #333;
			background-color: #F6F6F6;
		}
		body a {
			color: #333;
			opacity: 1;
		}
		body.profile .profile-section, body.map .profile-section, body.story .profile-section {
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			box-sizing: border-box;
			-webkit-justify-content: center;
			-moz-justify-content: center;
			justify-content: center;
			-ms-flex-pack: center;
			flex-pack: center;
			display: -webkit-box;
			display: -moz-box;
			display: -ms-flexbox;
			display: -webkit-flex;
			display: flex;
			-webkit-flex-direction: row;
			-moz-flex-direction: row;
			-ms-flex-direction: row;
			flex-direction: row;
			-webkit-flex-wrap: wrap;
			-ms-flex-wrap: wrap;
			flex-wrap: wrap;
			padding: 0 25px;
			width: 100vw;
		}
		body p {
			display: block;
			-webkit-margin-before: 1em;
			-webkit-margin-after: 1em;
			-webkit-margin-start: 0px;
			-webkit-margin-end: 0px;
			font-family: "Palanquin", sans-serif;
			font-size: 15px;
			line-height: 1.6;
			font-weight: 400;
			color: rgba(51, 51, 51, 0.93);
			background: #F6F6F6;
		}
		.h1, .h2, .h3, .h4, .h5, .h6, h1, h2, h3, h4, h5, h6 {
			font-family: inherit;
			font-weight: 500;
			line-height: 1.1;
			color: inherit;
		}
		h2 {
			display: block;
			font-size: 1.5em;
			-webkit-margin-before: 0.83em;
			-webkit-margin-after: 0.83em;
			-webkit-margin-start: 0px;
			-webkit-margin-end: 0px;
			font-weight: bold;
		}
		.topic {
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			box-sizing: border-box;
			-webkit-box-flex: 1 1 100%;
			-moz-box-flex: 1 1 100%;
			-webkit-flex: 1 1 100%;
			-ms-flex: 1 1 100%;
			flex: 1 1 100%;
			margin: 0;
			min-width: 100%;
			padding: 0 25px 50px;
		}
		body.profile .profile-section .topic, body.map .profile-section .topic, body.story .profile-section .topic {
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			box-sizing: border-box;
			-webkit-box-flex: 1 1 100%;
			-moz-box-flex: 1 1 100%;
			-webkit-flex: 1 1 100%;
			-ms-flex: 1 1 100%;
			flex: 1 1 100%;
			margin: 0;
			min-width: 100%;
			padding: 0 25px 50px;
		}
		body.profile .topic h2, body.map .topic h2, body.story .topic h2 {
			font-family: "Pathway Gothic One", sans-serif;
			font-size: 30px;
			font-weight: 400;
			color: #333;
			text-transform: none;
			font-style: normal;
			letter-spacing: 0;
			position: relative;
		}
		.section-title {
			font-family: "Pathway Gothic One", sans-serif;
			font-size: 47px;
			font-weight: 300;
			line-height: 1;
			letter-spacing: 0.02em;
			text-transform: uppercase;
		}
		body.profile .profile-section, body.map .profile-section, body.story .profile-section {
			-webkit-box-sizing: border-box;
			-moz-box-sizing: border-box;
			box-sizing: border-box;
			-webkit-justify-content: center;
			-moz-justify-content: center;
			justify-content: center;
			-ms-flex-pack: center;
			flex-pack: center;
			display: -webkit-box;
			display: -moz-box;
			display: -ms-flexbox;
			display: -webkit-flex;
			display: flex;
			-webkit-flex-direction: row;
			-moz-flex-direction: row;
			-ms-flex-direction: row;
			flex-direction: row;
			-webkit-flex-wrap: wrap;
			-ms-flex-wrap: wrap;
			flex-wrap: wrap;
			padding: 0 25px;
			width: 100vw;
		}
		#mortality-headr {
			background-color: #FFFFFF;
			flex-wrap: wrap;
			padding: 10px 10px 10px 0;
			background: #F6F6F6;
		}
		#snip-container {
			width: 100vw;
		}
		.item {
			font-size: 14px;
			letter-spacing: 1px;
			font-family: "Palanquin", sans-serif;
			font-weight: 400;
			text-transform: uppercase;
		}
		#specialEdits {
			margin-left: -43px;
		}
		body.profile .topic .sub-source, body.map .topic .sub-source, body.story .topic .sub-source {
			display: block;
			color: #a8a8a8;
			font-family: "Palanquin", sans-serif;
			font-size: 12px;
			font-weight: 400;
			line-height: 1.5;
		}
		#labelFormat {
			margin-left: 18%;
		}
		body.profile header .section-title, body.map header .section-title, body.story header .section-title {
			font-family: "Pathway Gothic One", sans-serif;
			font-size: 47px;
			font-weight: 300;
			line-height: 1;
			letter-spacing: 0.02em;
			text-transform: uppercase;
		}
		body.profile header .section-title, body.map header .section-title, body.story header .section-title {
			font-family: "Pathway Gothic One", sans-serif;
			font-size: 47px;
			font-weight: 300;
			line-height: 1;
			letter-spacing: 0.02em;
			text-transform: uppercase;
		}
{#		a:focus {#}
{#			outline: thin dotted;#}
{#			outline: 5px auto -webkit-focus-ring-color;#}
{#			outline-offset: -2px;#}
{#		}#}
		.section-title, a:focus, a:hover {
			color: #23527c;
{#			text-decoration: underline;#}
		}
{#        .section-title a:hover {#}
{#              text-decoration: underline; }#}
		.section-title, a {
			background-color: transparent;
		}
		body.profile .prof-body .section-title, body.map .prof-body .section-title, body.story .prof-body .section-title {
			margin: 0 auto 15px;
			color: #333;
		}
		body.profile .prof-body .section-title, body.map .prof-body .section-title, body.story .prof-body .section-title {
			margin: 0 auto 15px;
			color: #333;
		}
	</style>
  </head>

  <body class="profile geo">
		<article class="topic">
			<header class="mortality prof-body" id="mortality-headr">

				<h2 class="section-title"><a href="#mortality" name="mortality">Mortality</a></h2>
				<p>
					The Center for Disease Control collects mortality data over time.
			</header>
			</div>

			<h2 class="embed-title"> Mortality by sex</h2>

			<div id="specialEdits" class="col-sm-3 col-lg-3 text-left">
				<div class="topic-stats">
					<br>
					<br>
					<br>
					<br>
					<br>
					<br>
					<div class="col-sm-12">

						<div class="col-sm-6">
							<div class="stat">
								<div class="stat-text">
									2014
								</div>
								<!--<div class="stat-value">6,000,000</div>-->
							</div>
						</div>
						<div class="col-sm-6">
							<div class="stat">
								<!--<div class="stat-text">2014</div>-->
								<!--<div class="stat-value">6,000,000</div>-->
							</div>
						</div>
						<div class="col-sm-12">
							<div class="stat-value stat-small">
								Here we see data and a comparison of the
								sex for the causes fo death in the mortality data.<span class="stat-text">
							</div>
							<div class="stat-value stat-small sub-source">
								Dataset: 2014 CDC Mortality Data
								<Br>
								Source: Census Bureau
							</div>
						</div>
					</div>

				</div>
			</div>
			<div id="test2" class="col-sm-8 col-md-8 col-lg-8">
				<div id="chartOne"></div>
			</div>
			<div id="test" class="col-sm-8">
				<div id="mortalityCharts"></div>
			</div>
		</article>
		</section>
	</body>

  <script>
  	// provide the dropdown id and get the statement
  	var chartOne = function(containerName,currentState){
  		
  		var sections = ["sex","age","cause","race","state_name"];
  		
       //Creates selectable items found in dropdowns per each section
        var myFilters = {age : [
          {columnName:"age",value:"None"},
          {columnName:"age",value:"1 month - 11 months (includes not stated months)"},
          {columnName:"age",value:"1 year"},
          {columnName:"age",value:"10 - 14 years"},
          {columnName:"age",value:"100 years and over"},
          {columnName:"age",value:"15 - 19 years"},
          {columnName:"age",value:"2 years"},
          {columnName:"age",value:"20 - 24 years"},
          {columnName:"age",value:"25 - 29 years"},
          {columnName:"age",value:"3 years"},
          {columnName:"age",value:"30 - 34 years"},
          {columnName:"age",value:"35 - 39 years"},
          {columnName:"age",value:"4 years"},
          {columnName:"age",value:"40 - 44 years"},
          {columnName:"age",value:"45 - 49 years"},
          {columnName:"age",value:"5 - 9 years"},
          {columnName:"age",value:"50 - 54 years"},
          {columnName:"age",value:"55 - 59 years"},
          {columnName:"age",value:"60 - 64 years"},
          {columnName:"age",value:"65 - 69 years"},
          {columnName:"age",value:"70 - 74 years"},
          {columnName:"age",value:"75 - 79 years"},
          {columnName:"age",value:"80 - 84 years"},
          {columnName:"age",value:"85 - 89 years"},
          {columnName:"age",value:"90 - 94 years"},
          {columnName:"age",value:"95 - 99 years"}
        ], cause : [
          {columnName:'cause',value:"None"},
          // {columnName:'cause',value:"Tuberculosis"},
          // {columnName:'cause',value:"Hypertensive heart disease with or without renal disease"},
          // {columnName:'cause',value:"Non-Hodgkin's lymphoma"},
          // {columnName:'cause',value:"Syphilis"},
          // {columnName:'cause',value:"Malignant neoplasms of colon, rectum and anus"},
          // {columnName:'cause',value:"Intentional self-harm (suicide)"},
          // {columnName:'cause',value:"Nephritis, nephrotic syndrome, and nephrosis"},
          // {columnName:'cause',value:"Malignant neoplasm of breast"},
          // {columnName:'cause',value:"Peptic ulcer"},
          // {columnName:'cause',value:"Pregnancy, childbirth and the puerperium"},
          // {columnName:'cause',value:"Sudden infant death syndrome"},
          // {columnName:'cause',value:"Other diseases of circulatory system"},
          // {columnName:'cause',value:"Chronic liver disease and cirrhosis"},
          // {columnName:'cause',value:"Malignant neoplasms of cervix uteri, corpus uteri and ovary"},
          // {columnName:'cause',value:"Diabetes mellitus"},
          // {columnName:'cause',value:"Atherosclerosis"},
          // {columnName:'cause',value:"Leukemia"},
          // {columnName:'cause',value:"Malignant neoplasm of prostate"},
          // {columnName:'cause',value:"Assault (homicide)"},
          // {columnName:'cause',value:"Malignant neoplasm of pancreas"},
          // {columnName:'cause',value:"Motor vehicle accidents"},
          // {columnName:'cause',value:"Chronic lower respiratory diseases"},
          // {columnName:'cause',value:"All other external causes"},
          // {columnName:'cause',value:"All other and unspecified accidents and adverse effects"},
          // {columnName:'cause',value:"Alzheimer's disease"},
          // {columnName:'cause',value:"Influenza and pneumonia"},
          // {columnName:'cause',value:"Human immunodeficiency virus (HIV) disease"},
          // {columnName:'cause',value:"Malignant neoplasms of urinary tract"},
          // {columnName:'cause',value:"Essential (primary) hypertension and hypertensive renal disease"},
          // {columnName:'cause',value:"Malignant neoplasm of stomach"},
          // {columnName:'cause',value:"Cerebrovascular diseases"},
          // {columnName:'cause',value:"Symptoms, signs and abnormal clinical and laboratory findings, not elsewhere classified (excluding Sudden infant death syndrome)"},
          // {columnName:'cause',value:"Certain conditions originating in the perinatal period"},
          // {columnName:'cause',value:"Congenital malformations, deformations and chromosomal abnormalities"}
          {columnName:'cause',value:"All other diseases (Residual)"},
          {columnName:'cause',value:"Ischemic heart diseases"},
          {columnName:'cause',value:"Malignant neoplasms of trachea, bronchus and lung"},
          {columnName:'cause',value:"Other diseases of heart"},
          {columnName:'cause',value:"Other malignant neoplasms"},
        ], sex : [
          {columnName:'sex',value:"None"},
          {columnName:'sex',value:"Male"},
          {columnName:'sex',value:"Female"}
        ], race : [
          {columnName:'sex',value:"None"},
          {columnName:'sex',value:"Black"},
          {columnName:'sex',value:"American Indian (includes Aleuts and Eskimos)"},
          {columnName:'sex',value:"Chinese"},
          {columnName:'sex',value:"Filipino"},
          {columnName:'sex',value:"White"}
        ]
      };

      var createDropdown = function(myOptions,parentName,section,labelHolder,ddHolder){
      	capLable = section.toUpperCase();

        var parent = $('#'+parentName);
        var labelParent = $('#'+labelHolder);
        var filterParent = $('#'+ddHolder);
    	
    	// placec chart specific labels to label div of chart
    	labelParent.append('<label id="labelFormat" for="'+labelParent+'_'+section+'_selector">'+capLable+'</label>');
        
        filterParent.append('<select id="'+ddHolder+'_'+section+'_selector" class="btn btn-default mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent" style="width:25%"></select>');
    	
        //parent.append('<label for="'+parentName+'_'+section+'_selector">'+capLable+'</select>');
        //parent.append('<select id="'+parentName+'_'+section+'_selector" class="btn btn-default btn-block mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent"></select>');

        var mySelect = $('#'+parentName+'_' +section+'_selector');
        var mySelect2 = $('#'+ddHolder+'_' +section+'_selector');

        $.each(myOptions, function(optionIndex, optionObject) {
            //mySelect.append(
            //    $('<option></option>').val(optionObject.value).html(optionObject.value)
            //);
            mySelect2.append(
                $('<option></option>').val(optionObject.value).html(optionObject.value)
            );
        });
        return mySelect;
      };
      //Filter used onChange for each of the dropdowns
      //Returns new array of filtered data
      var filter = function(data, myFilters){
        var new_arr = [];
        $.each(data, function(dataIndex, dataRow) {
          var include = true;
          $.each(myFilters, function(filterIndex, filterRow) {
            if(dataRow[filterRow.columnName] != filterRow.value)
              include = false;
          });
          if(include)
            new_arr.push(dataRow);
        });
        return new_arr;
      };
      	
      $.each(sections, function(index, section) {
      	//Captilize the chart title
      	chartTitle = section.toUpperCase();
      	
        //create an id
        var myContainerName = 'chartOne_'+section;

        //graphic container is split into two sections, one for the filter and the other for the graph
        var filterContainerName = myContainerName+'_filters';
        var graphContainerName = myContainerName+'_graph';
        
        // label for each filter
        var chartFilterLabel = myContainerName+'_label';

        //Set the title for the chart
        $('#'+containerName).append('<h2 id="'+chartTitle+'theTItle" class="embed-title text-center"><a href="#chartOne" name="income_sex">'+chartTitle+'</a> <a href="#chartOne" class="btn pri-btn data-btn" data-target-id="null" data-embed="/null" data-url="null" id="DeloitteCustomButton"><span>Options</span></a></h2>');
        
        // div to hold filter labels
        $('#'+containerName).append('<div id="'+chartFilterLabel+'" class="col-sm-12"></div>');
        
        //div to hold drop down filter for each chart
        //$('#'+containerName).append('<div id="'+filterContainerName+'" class="col-sm-12"></div>');
 
        //Add an options button
        $('#'+containerName).append('<div id="'+myContainerName+'"><div id="'+filterContainerName+'"></div><br/><div id="'+graphContainerName+'"></div></div>');
	    
	    //$('#'+containerName).append('<div id="'+myContainerName+'"><div id="'+graphContainerName+'"></div></div>');

        //we add the graph to the graph container
        var myScatter;
        if(section!='state_name'){
          if(section=='sex'){
            myScatter = d3plus.viz()
            		
                    .container('#'+graphContainerName)
                    .type("bar")
                    .data(mortalityData)
                    .id(section)
                    .y(section)
                    .x("count")
                    .y({"scale": "discrete"})
                    .color(function(d){
						if(d.sex == "Male"){
							return "#C6C7CA";
						}
						else{
							return "#ef6145";
						}
					}).background("#F6F6F6").axes({"background": {"color":"#F6F6F6"}}) 
                    .height(300)
                    .width(800)
                    .draw();
          }else{

            myScatter = d3plus.viz()
                    .container('#'+graphContainerName)
                    .type("bar")
                    .data(mortalityData)
                    .id(section)
                    .x(section)
                    .y("count")
                    .color(section)
                    .height(400)
                    .width(800)
                    .draw();
          }
        };

        var myFilter = [];

        //dropdown creation
        //We create multiple filters per each graph, all named after the sections [age,race,sex]
        $.each(sections, function(index, sectionTwo) {
          if(section != sectionTwo && sectionTwo!='state_name'){
            var myDropdown = createDropdown(myFilters[sectionTwo],filterContainerName,sectionTwo,chartFilterLabel,filterContainerName);
            myDropdown.change(function(){
              //value of dropdown
              var b = myDropdown.val();

              //remove previous filters for this sectionTwo (only one age filter allowed at once)
              var removeIndex = -1;
              $.each(myFilter, function(filterIndex, filterRow) {
                if(filterRow.columnName == sectionTwo)
                  removeIndex = filterIndex;
              });
              //if we found a filter on this category already then we remove it
              if(removeIndex >= 0)
                myFilter.splice(removeIndex,1);

              //add the new filter
              if(b != "None")
              myFilter.push({"columnName":sectionTwo,"value":b});
              //filter the data and populate the graph
              myScatter.data(filter(mortalityData, myFilter)).draw();
            });
          }
        });// end of dropdown creation
      });//end of section loop
      
  	};
  	//******************* original script ***********************/ 
    //currentState can be set to null
    //  it only changes the text of the [currentState] within the tree-map
    var createMortalityCharts = function(containerName,currentState){

      //We create a dropdown under "parentName" and return the newly added object to reference later
      var createDropdown = function(myOptions,parentName,section){
        var parent = $('#'+parentName);
        parent.append('<label for="'+parentName+'_'+section+'_selector">'+section+'</select>');
        parent.append('<select id="'+parentName+'_'+section+'_selector"></select>');

        var mySelect = $('#'+parentName+'_' +section+'_selector');

        $.each(myOptions, function(optionIndex, optionObject) {
            mySelect.append(
                $('<option></option>').val(optionObject.value).html(optionObject.value)
            );
        });
        return mySelect;
      };
      //Filter used onChange for each of the dropdowns
      //Returns new array of filtered data
      var filter = function(data, myFilters){
        var new_arr = [];
        $.each(data, function(dataIndex, dataRow) {
          var include = true;
          $.each(myFilters, function(filterIndex, filterRow) {
            if(dataRow[filterRow.columnName] != filterRow.value)
              include = false;
          });
          if(include)
            new_arr.push(dataRow);
        });
        return new_arr;
      };

        //List of Sections and their filters
        //DELECT array items to change the number of charts displayed
        var sections = ["sex","age","cause","race","state_name"];

        //Creates selectable items found in dropdowns per each section
        var myFilters = {age : [
          {columnName:'age',value:"None"},
          {columnName:"age",value:"1 month - 11 months (includes not stated months)"},
          {columnName:"age",value:"1 year"},
          {columnName:"age",value:"10 - 14 years"},
          {columnName:"age",value:"100 years and over"},
          {columnName:"age",value:"15 - 19 years"},
          {columnName:"age",value:"2 years"},
          {columnName:"age",value:"20 - 24 years"},
          {columnName:"age",value:"25 - 29 years"},
          {columnName:"age",value:"3 years"}

        ], cause : [
          {columnName:'cause',value:"None"},
          {columnName:'cause',value:"All other diseases (Residual)"},
          {columnName:'cause',value:"Ischemic heart diseases"},
          {columnName:'cause',value:"Malignant neoplasms of trachea, bronchus and lung"},
          {columnName:'cause',value:"Other diseases of heart"},
          {columnName:'cause',value:"Other malignant neoplasms"}
        ], sex : [
          {columnName:'sex',value:"None"},
          {columnName:'sex',value:"Male"},
          {columnName:'sex',value:"Female"}
        ], race : [
          {columnName:'sex',value:"None"},
          {columnName:'sex',value:"Black"},
          {columnName:'sex',value:"American Indian (includes Aleuts and Eskimos)"},
          {columnName:'sex',value:"Chinese"},
          {columnName:'sex',value:"Filipino"},
          {columnName:'sex',value:"White"}
        ]
      };

      $.each(sections, function(index, section) {
        //create an id
        var myContainerName = 'mortality_'+section;

        //graphic container is split into two sections, one for the filter and the other for the graph
        var filterContainerName = myContainerName+'_filters';
        var graphContainerName = myContainerName+'_graph';

        //Set the title for the chart
        $('#'+containerName).append('<h2 class="embed-title"><a href="#mortality" name="income_sex">Mortality</a> <a href="#mortality" class="btn pri-btn data-btn" data-target-id="null" data-embed="/null" data-url="null" id="DeloitteCustomButton"><span>Options</span></a></h2>');
        //Add an options button
        $('#'+containerName).append('<div id="'+myContainerName+'"><div id="'+filterContainerName+'"></div><br/><div id="'+graphContainerName+'"></div></div>');

        //we add the graph to the graph container
        var myScatter;
        if(section!='state_name'){
        	console.log(section);
          if(section=='sex'){
            myScatter = d3plus.viz()
                    .container('#'+graphContainerName)
                    .type("bar")
                    .data(mortalityData)
                    .id(section)
                    .y(section)
                    .x("count")
                    .y({"scale": "discrete"})
                    .color(section)
                    .height(300)
                    .width(800)
                    .draw();
          }else{
          	console.log(section + "After first else");
            myScatter = d3plus.viz()
                    .container('#'+graphContainerName)
                    .type("bar")
                    .data(mortalityData)
                    .id(section)
                    .x(section)
                    .y("count")
                    .color(section)
                    .height(400)
                    .width(800)
                    .draw();
          }
        }else{
          //Creates a treemap
          console.log(section + " Tree map");
          myScatter = d3plus.viz()
            .container('#'+graphContainerName)  // container DIV to hold the visualization
            .data(mortalityData)  // data to use with the visualization
            .type("tree_map")   // visualization type
            .id("state_name")   // key for which our data is unique on
            .size("count")      // sizing of blocks
            .height(400)
            .width(800)
            .text(function(a,b,c,d){
              if(a.d3plus_label && a.d3plus_label.names){
                // a.d3plus_label.names[0]=a.value + "% \n stdv(" +a.sderror+ ") \n ci("+a['ci-low']+"-"+a['ci-high']+")";
                return null;//it will output the id as the header within the hover menu with this null
              }
              return a.state_name + (a.state_name==currentState?"*":"");
            })
            .draw()   ;          // finally, draw the visualization!
        };

        var myFilter = [];

        //dropdown creation
        //We create multiple filters per each graph, all named after the sections [age,race,sex]
        $.each(sections, function(index, sectionTwo) {
          if(section != sectionTwo && sectionTwo!='state_name'){
            var myDropdown = createDropdown(myFilters[sectionTwo],filterContainerName,sectionTwo);
            myDropdown.change(function(){
              //value of dropdown
              var b = myDropdown.val();

              //remove previous filters for this sectionTwo (only one age filter allowed at once)
              var removeIndex = -1;
              $.each(myFilter, function(filterIndex, filterRow) {
                if(filterRow.columnName == sectionTwo)
                  removeIndex = filterIndex;
              });
              //if we found a filter on this category already then we remove it
              if(removeIndex >= 0)
                myFilter.splice(removeIndex,1);

              //add the new filter
              if(b != "None")
              myFilter.push({"columnName":sectionTwo,"value":b});
              //filter the data and populate the graph
              myScatter.data(filter(mortalityData, myFilter)).draw();
            });
          }
        });// end of dropdown creation
      });//end of section loop
    };//end of create charts
    
    //Create Mortality charts within specified container id
    //createMortalityCharts('mortalityCharts','California');
    chartOne('chartOne','California');
    
  </script>

</html>
