{% extends "templates/nav.html" %}

{% block body %}


<div class="bg"></div>

<section class="home-desc">
  <img class="page-1" src="/static/img/home/page-1.png" alt="WomenData" />
    <br>
	<h2 class="Comprehensive-Data-f" id="home-header">Comprehensive Data for U.S. Women's Health</h2>
</section>

<section class="search-home-container">
    <div class="dropdown">
      <button class="btn btn-wide dropdown-toggle" type="button" id="yrbs_topic_btn" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" data-table-id="">
        Choose a Category To Explore
        <span class="caret"></span>
      </button>
      <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
        <li><a href="#" data-table-id="yrbs2015" value="texted_or_emailed_while_driving">Youth Risky Behavior</a></li>
        <li><a href="#" data-table-id="yrbs2015" value="texted_or_emailed_while_driving">Mortality</a></li>
{#        <li class="dropdown-header">Youth Risky Behaviors - National Level 2015</li>#}
{#            <li><a href="#" data-table-id="yrbs2015" value="texted_or_emailed_while_driving">Texted or emailed while driving in the last 30 days</a></li>#}
{#            <li><a href="#" data-table-id="yrbs2015" value="currently_smoked_cigarettes">Currently smokes cigarettes</a></li>#}
{#            <li><a href="#" data-table-id="yrbs2015" value="currently_used_electronic_vapor_products">Ever used an electronic vapor product</a></li>#}
{#            <li><a href="#" data-table-id="yrbs2015" value="were_electronically_bullied">Been electronically bullied in the last 12 months</a></li>#}
{#            <li><a href="#" data-table-id="yrbs2015" value="had_sex_with_four_or_more">Had sexual intercourse with four (4) or more people during lifetime</a></li>#}
{#            <li><a href="#" value="had_8_or_more_hours_of_sleep">Regularly gets 8 or more hours of sleep</a></li>#}
{#        <li role="separator" class="divider"></li>#}
{#        <li class="dropdown-header">2014 Mortality</li>#}
{#          <li><a href="#" data-table-id="vs2014mort" value="resident_status">Resident Status</a></li>#}
{#          <li><a href="#" data-table-id="vs2014mort" value="place_of_death_and_decedents_status">Place Of Death And Decedents Status</a></li>#}
{#          <li><a href="#" data-table-id="vs2014mort" value="injury_at_work">Injury At Work</a></li>#}
{#          <li><a href="#" data-table-id="vs2014mort" value="manner_of_death">Manner Of Death</a></li>#}
{#          <li><a href="#" data-table-id="vs2014mort" value="method_of_disposition">Method Of Disposition</a></li>#}
{#          <li><a href="#" data-table-id="vs2014mort" value="activity_code">Activity Code</a></li>#}
{#          <li><a href="#" data-table-id="vs2014mort" value="place_of_injury">Place Of Injury</a></li>#}
{#          <li><a href="#" data-table-id="vs2014mort" value="cause">Cause</a></li>#}
{#          <li role="separator" class="divider"></li>#}
{#        <li class="dropdown-header">Youth Risky Behaviors - State Level 2000 - 2013</li>#}
{#          <li><a href="#" data-table-id="yrbs2013state" value="sexual_contact">Sexual Contact</a></li>#}
{#          <li><a href="#" data-table-id="yrbs2013state" value="texted_or_emailed_while_driving">Texted Or Emailed While Driving</a></li>#}
{#          <li><a href="#" data-table-id="yrbs2013state" value="electronically_bullied_in_past_year">Electronically Bullied In Past Year</a></li>#}
{#          <li><a href="#" data-table-id="yrbs2013state" value="smoked_in_past_30_days">Smoked In Past 30 Days</a></li>#}
{#          <li><a href="#" data-table-id="yrbs2013state" value="had_sex_with_4_or_more_people">Had Sex With 4 Or More People during lifetime</a></li>#}
{#          <li><a href="#" data-table-id="yrbs2013state" value="had_8_or_more_hours_of_sleep">Regularly Gets 8 Or More Hours Of Sleep</a></li>#}


      </ul>
    </div>
{#	<div class="search-input-btn">#}
{#		<input type="text" data-results="search-home" data-search="home" id="home-search-input" class="search-input" />#}
{#		<select id="search-type">#}
{#			<option value="all">All</option>#}
{#			<option value="geo">Locations</option>#}
{#			<option value="naics">Industries</option>#}
{#			<option value="soc">Occupations</option>#}
{#			<option value="cip">Education</option>#}
{#		</select>#}
{#		<a href="/search/" id="search-switch" class="adv" onclick="advSearch.toggle();">Search</a>#}
{#	</div>#}
{#	<div id="search-home" class="search-body">#}
{#    <div class="no-search-results">No results found</div>#}
{#		<div class="search-results"></div>#}
{#	</div>#}
{#  <section class="results-show-all">#}
{#    <a href="/search/" class="pri-link">Show all results <span class="more"></span></a>#}
{#  </section>#}
</section>

<div class="home-collab">
	<span class="collab-text">Created in Collaboration</span>
	<a target="_blank" href="http://www2.deloitte.com/us/en.html"><img id="deloitte" src="/static/img/footer/deloitte.png" /></a>
	<a target="_blank" href="http://macro.media.mit.edu/"><img id="macro" src="/static/img/footer/mit.png" /></a>
	<a target="_blank" href="http://www.datawheel.us/"><img id="datawheel" src="/static/img/footer/datawheel.png" /></a>
</div>




<div id="feed">
{% for box in feed %}
	<a href="{{ box.link }}" class="feed-box {{ box.type.title|lower }} {{ box.type.type|lower }}{% if box.featured %} featured{% endif %}">
		{% if box.image %}
		<div class="feed-box-image-holder">
			<div class="feed-box-image" style="background-image:url('{{ box.image }}');"></div>
		</div>
		{% endif %}
		{% if box.viz %}
		<div class="feed-box-viz {{ box.viz }}" style="background-image:url('/static/img/viz_type/{{ box.viz }}.svg');"></div>
		{% endif %}
		<div class="feed-box-label">
			<div class="feed-box-type">
				<img src="{{ box.type.icon }}" />
				<span class="feed-box-header">{{ box.type.title }}</span>
			</div>
			{% if box.type.depth %}
			<span class="feed-box-depth feed-box-header">{{ box.type.depth }}</span>
			{% endif %}
			{% if box.section %}
			<div class="feed-box-section">
				<img src="{{ box.section.icon }}" />
				<span class="feed-box-header">{{ box.section.title }}</span>
			</div>
			{% endif %}
		</div>
		<div class="feed-box-title">{{ box.title }}</div>
		{% if box.featured or box.type.type != "story" %}
		<div class="feed-box-header feed-box-subtitle">{{ box.subtitle }}</div>
		{% endif %}
		{% if box.author %}
		<div class="feed-box-header feed-box-author">{{ box.author }}</div>
		<div class="feed-box-header feed-box-link">Read More</div>
		{% endif %}
		{% if box.featured and box.type.title != "Profile" %}
		<div class="feed-box-tag">Featured</div>
		{% endif %}
	</a>
{% endfor %}
</div>

{% endblock %}

{% block js %}

<script>

	var firstForm = true;
	var searchForm = d3plus.form()
		.data("#search-type")
		.font("Palanquin")
		.focus("all", function(f){
			if (firstForm) {
				firstForm = false;
			}
			else {
			  window.clearTimeout(tout);
				search.type = f === "all" ? "" : f;
				// search.reload();
		    search_input.node().focus();
			}
		})
		.ui({
			"margin": 0
		})
		.draw();

	// var h = window.innerHeight,
	//     w = window.innerWidth;

	// var paralax_ids = ["logo-shadow", "logo", "desc-shadow", "desc", "fg"];

	// var paralax_data = paralax_ids.map(function(d){
	//   var elem = d3.select("#" + d),
	//       mod = ((parseFloat(elem.style("width"), 10) - w)/w) * 100;
	//   return {
	//     "elem": elem,
	//     "mod": mod,
	//     "x": d3.scale.linear().domain([0, w]).range([0, -mod]),
	//     "y": d3.scale.linear().domain([0, h]).range([0, -mod])
	//   }
	// })

	// d3.select("body").on(d3plus.client.pointer.move, function(){
	//   var mouse = d3.mouse(this);
	//   paralax_data.forEach(function(d){
	//     d.elem.style("left", d.x(mouse[0]) + "%").style("top", d.y(mouse[1]) + "%");
	//   });
	// });

	// var bg_imgs = [1, 6];
	// var bg_img = "" + (Math.floor(Math.random() * bg_imgs[1]) + 1);
	// d3.select(".bg").style("background-image", "url('/static/img/home/bg/" + bg_img + ".jpg')");
	var bg_img = "1";
	localforage.setItem("homepage_image", bg_img);

	var homeInput = d3.select("#home-search-input");
	d3.select("#search-switch.adv").on("click", function(){
		d3.event.preventDefault();
		window.location = "/search/?q=" + homeInput.node().value + "&kind=" + search.type;
	});

	d3.select("#home-search-input").on("input", function() {
	  window.clearTimeout(tout);
	  var inputText = document.getElementById("home-search-input").value;
	  d3.select(".search-input-text").text(inputText);
	});

	d3.select("#home-search-input").on("keyup.clear_demo", function() {
	  window.clearTimeout(tout);
		d3.event.preventDefault();
	});

	var search_input = d3.select("#home-search-input");
	var current_search_term = search_input.property("value");
	var results_div_id = search_input.attr("data-results");
	var results_div = d3.select("#"+results_div_id);
	search.term = current_search_term;
	search.container = d3.select("#search-" + search_input.attr("data-search"));
	if(current_search_term.length){
	  results_div.classed("open", true);
	  search.reload();

	  search_input.node().focus();
	}

	var demo_input = document.getElementById('home-search-input');

	var letter_index = 0;
	var tout = 0;
	var sterms = ["Boston", "Computer Science", "Civil Engineers", "Cook County", "Hospitals", "02139", "California", "Biology"]
	var sterm_index = 0;
	var type_this = sterms[sterm_index];
	var ready = true;

	window.next_letter = function() {
	  var interval = 100;
	  if (letter_index <= type_this.length) {
	    search_input.property("value", type_this.substr(0, letter_index++));
	    if(letter_index > type_this.length){
	      interval = interval * 30;
	      // search_input.on("click")();
	    }
	  }
	  else {
	    letter_index = 0;
	    d3.select(document).on("click")();
	    // search_input.node().focus();
	    sterm_index = (sterm_index+1)%sterms.length;
	    type_this = sterms[sterm_index];
	  }
	  tout = setTimeout("next_letter()", interval);
	}

	search_input.on("click.clear", function(){
	  this.select();
	  window.clearTimeout(tout);
	})

	next_letter();

</script>

{% endblock %}
